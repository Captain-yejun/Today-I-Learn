# NFS란 무엇인가?
- Network File System

- 클라이언트 컴퓨터가 로컬에 저장된 것처럼 네트워크를 통해 파일에 접근할 수 있도록 하는 분산 파일 시스템 프로토콜이다.

- 클라이언트는 공유된 디렉토리를 자체 시스템에 마운트하고 로컬인 것처럼 해당 디렉토리 내의 파일에 접근할 수 있다.

- 즉, 네트워크상 다른 컴퓨터의 파일 시스템을 마치 자기 것처럼 사용할 수 있는 것

- 회사에서 공유 폴더를 통해서 공용 파일을 보관해두는 폴더를 볼 수 있었을 것이다.
이 때, 사용된 개념이 NFS이다.

![image](https://github.com/user-attachments/assets/8039c9c4-9184-4e6c-9163-c3bbe4687d47)
> 공유 폴더를 마운트하여 로컬 디렉토리처럼 사용
<br>
<hr>
<br>

## ✔️ 장점
- 파일 잠금을 지원하므로 여러 사용자가 동일한 파일을 동시에 수정할 수 없다.

- 사용자가 파일을 공유하고 공동 작업을 더 쉽게 수행할 수 있다.
<br>
<hr>
<br>

## ✔️ 단점
- 기본적으로 암호화 또는 인증을 제공하지 않기 때문에 다른 파일 공유 프로토콜보다 보안 수준이 낮을 수 있다.

- 서버와 클라이언트가 여러 개인 대규모 환경에서 설정 및 구성이 어려울 수도 있다.
<br>
<hr>
<br>

## ✔️ 시스템 구조
- NFS 시스템의 구조는 클라이언트, 서버, 네트워크 세 가지를 주요 구성요소로 볼 수 있다.

- 클라이언트 : 네트워크를 통해 파일에 접근하는 사용자
  - mount 명령을 사용하여 서버에서 내보낸 디렉토리 자체를 자체 파일 시스템에 마운트한다.
<br>

- 서버 : 클라이언트의 원격 접근을 위해 네트워크를 통해서 하나 이상의 디렉토리를 내보내는 시스템
  - 내보낸 파일 시스템을 관리하고, 클라이언트 요청에 응답한다.
<br>

- 네트워크 : 클라이언트와 서버 간의 통신 채널을 제공
  - LAN 또는 WAN 사용
<br>

![image](https://github.com/user-attachments/assets/e8ff26ee-bc4f-45c4-b85e-570d794da15f)
> RPC와 RCBIND 개념이 등장
<br>

## ✔️ RPC란?
- Remode Procedure Call

- 실행중인 프로그램이 네트워크 통신에서 낮은 수준의 세부 사항을 처리하지 않고도 원격 컴퓨터에서 절차나 기능을 실행할 수 있도록 도와주는 프로토콜

- RPC 사용 시 실행중인 프로그램이 로컬 함수 또는 프로시저인 것 처럼 원격 컴퓨터의 함수 또는 프로시저를 호출 할 수 있다.

- 즉 프로그램이 원격 컴퓨터에 기능 실행 요청을 보내면 원격 컴퓨터가 요청 받은 기능의 결과를 응답한다.

- 클라이언트 - 서버 간의 요청-응답 모델을 기반으로 한다.

- TCP/IP 통신 사용
<br>
<hr>
<br>

## ✔️ RCBIND란?
- Remote Procedure Call Bind

- 클라이언트가 네트워크에서 RPC서비스를 동적으로 검색하고, 연결할 수 있도록 도와주는 서비스

- 클라이언트가 서버의 RPC 서비스에 접근하기 위해서는 서비스를 수신 중인 포트 번호를 알아야 한다.

- 즉, RPC에 의존하는 NFS를 위해 유닉스 및 리눅스 환경에서 사용
<br>
<hr>
<br>

## ✔️ 동작 과정
- 클라이언트는 네트워크를 통해 서버의 파일 또는 디렉토리에 접근을 요청

- 서버는 해당 요청에 대해 데이터로 응답한다.
<br>
<hr>
<br>

## ✔️ NFS 구성을 위한 작업 단계
- 서버의 디렉토리 공유
  - NFS 서버가 네트워크상에 존재하는 클라이언트에게 하나 이상의 디렉토리를 공유
  - 관리자는 NFS 서버 구성 파일에서 공유할 디렉터리를 지정
<br>

- 클라이언트에서 서버의 디렉토리 마운트
  - NFS 클라이언트는 mount 명령을 사용하여 서버에서 내보낸 디렉토리를 자체 파일 시스템에 마운트
  - mount 명령은 서버의 호스트 이름 또는 IP 주소, 내보낸 디렉토리의 이름 및 클라이언트의 마운트 지점을 지정
  - mount : 하드웨어장치와 특정 디렉토리를 연결하는 작업을 의미
<br>

- 데이터 요청
  - 서버가 공유한 디렉터리가 마운트 되면 클라이언트가 로컬인 것처럼 디렉터리 내의 파일에 접근 가능
  - 클라이언트는 파일 읽기, 쓰기, 만들기, 삭제 또는 수정과 같은 파일 작업에 대한 요청을 서버로 보냄
<br>

- 원격 프로시저 호출(RPC)
  - 클라이언트는 RPC 프로토콜을 사용하여 서버에 요청을 보냄
  - 해당 프로토콜을 사용하면 클라이언트가 서버의 함수 또는 프로시저를 로컬인 것처럼 호출하는 것
<br>

- 파일 접근
  - 서버는 클라이언트로부터 RPC 요청을 수신하고, 공유한 디렉토리에서 요청된 파일 작업을 수행
  - 서버는 요청된 작업의 결과를 클라이언트에 다시 공유
<br>

****
- 캐싱
  - 성능 향상을 위해 NFS 클라이언트는 파일 데이터를 로컬에 캐싱
  - 클라이언트는 파일 데이터의 복사본을 메모리에 보관하므로 접근할 때마다 서버에서 데이터를 검색할 필요가 없어짐
  - 클라이언트는 권한, 소유권 및 타임스탬프와 같은 파일 속성을 캐시 할 수 있다.
<br>

- 일관성
  - NFS는 동일한 파일에 접근하는 여러 클라이언트에서 데이터 일관성을 유지하기 위해 파일 잠금 메커니즘을 사용
  - 파일 잠금을 사용하면 여러 클라이언트가 동일한 파일을 동시에 수정할 수 없으므로 한 번에 하나의 클라이언트만 파일을 수정 가능
  - 회사 공용 폴더를 누군가 수정하고 있으면, 다른 사람이 수정못하는 경우이다.
<br>

- 보안
  - 인증 및 암호화와 같은 보안 기능을 제공하도록 구성 가능
  - Ex) NFS 버전 4는 Kerberos 인증 및 TLS(Transport Layer Security) 암호화를 지원하여 네트워크를 통해 전송되는 데이터를 보호
<br>

![image](https://github.com/user-attachments/assets/455b264e-6e27-48f0-a31b-0ef9071da847)
<br>
<hr>
<br>


**Reference**<br>

[오몰내알 : NFS란? 정의/장단점](https://kgw7401.tistory.com/51)<br>
[coinAA : Linux NFS 구축하며 개념, 구조, 동작원리까지 모두 알아보기](https://onecoin-life.com/87)
