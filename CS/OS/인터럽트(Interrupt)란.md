## 인터럽트(Interrupt)란?
- CPU가 특정 기능을 수행하는 도중에 급하게 다른 일을 처리하고자 할 때 사용할 수 있는 기능이다.

- 프로세스 실행 도중 예기치 않은 상황이 발생할 때, 발생한 상황을 처리한 후 실행 중인 작업으로 복귀하는 것을 말한다.

- 주로 입출력 장치의 signal, data가 발생할 때까지 원래의 작업을 수행하다가 해당 기능을 처리하는 것이다. (외부 인터럽트)
<br>
<hr>
<br>

### ✔ 종류
**하드웨어적 인터럽트**
- 전원 이상, 기계 착오, 외부 신호, 입출력 등 프로세스 외부에서 발생하는 인터럽트
  - 전원 이상 인터럽트 : 정전이나 전원이 이상이 있는 경우
  - 기계 고장 인터럽트 : CPU등의 기능적인 동작 오류가 발생한 경우
  - 입출력 인터럽트(I/O Interrupt): 입출력의 종료 등의 이유로 CPU의 수행을 요청하는 인터럽트.
<br>
<br>

**소프트웨어적 인터럽트**
- 프로세스 내부에서 잘못된 명령어, 데이터로 exception이 발생하는 것이며 trap이라고 불림
  - 0으로 나누는 경우
  - 오버플로우 또는 언더플로우가 발생한 경우
  - 프로그램 상의 오류
  - 프로그램에서 함수 등 명령어를 잘못 사용한 경우
  - 예외를 처리하던 중 또 다른 예외가 발생할 경우, Double Fault이라고 부른다.
<br>
<hr>
<br>

### ✔ 인터럽트가 발생하는 이유
- 입출력 연산이 CPU 명령 수행속도보다 현저히 느리기 때문이다. 

- CPU는 성능을 최대로 발휘하기 위함이다.
  - CPU는 단시간에 많은 연산을 처리할 수 있는 능력을 가졌으므로, 입출력 연산을 하는 동안 CPU가 쉬게되면 손해이다.
  - 그러므로 다른 작업 중에도 CPU 성능을 활용하기 위해 ISR을통해 작업을 처리한다.
  - 작업을 완료하면 CPU에게 작업 완료를 알려주는 것이 인터럽트이다.
  - 인터럽트가 되면 CPU는 기존에 진행했었던 작업이 있다면 이어서 한다.
<br>
<hr>
<br>

### ✔ 인터럽트 과정
process A 실행 중 디스크에서 어떤 데이터를 읽어오라는 명령을 받았다고 가정해보자.

- process A는 system call을 통해 인터럽트를 발생시킨다.

- CPU는 현재 진행 중인 기계어 코드를 완료한다.

- 현재까지 수행중이었던 상태를 해당 process의 PCB(Process Control Block)에 저장한다. (수행중이던 MEMORY주소, 레지스터 값, 하드웨어 상태 등...)

- PC(Program Counter, IP)에 다음에 실행할 명령의 주소를 저장한다.

- 인터럽트 벡터를 읽고 ISR 주소값을 얻어 ISR(Interrupt Service Routine)로 점프하여 루틴을 실행한다.

- 해당 코드를 실행한다.

- 해당 일을 다 처리하면, 대피시킨 레지스터를 복원한다.

- ISR의 끝에 IRET 명령어에 의해 인터럽트가 해제 된다.

- IRET 명령어가 실행되면, 대피시킨 PC 값을 복원하여 이전 실행 위치로 복원한다.
<br>
<hr>
<br>

### ✔ 인터럽트 서비스 루틴(ISR : Interrupt Service Routine)
- 인터럽트가 발생하면 처리하기 위한 루틴인 ISR이 실행된다.

![image](https://github.com/yejun95/Today-I-Learned/assets/121341413/df86c6ad-5713-45ad-842d-e87417fc12e2)
<br>
<br>

- 주 프로그램 작업 수행 중 인터럽트 발생
- 주 프로그램 상태 레지스터와 PC 등을 스택에 잠시 저장
- 인터럽트 서비스 루틴으로 점프, 처리
- 다시 주 프로그램 작업 복귀
<br>
<hr>
<br>

**Reference**<br>

[wannabeking : 인터럽트(Interrupt)란?](https://velog.io/@pppp0722/%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8Interrupt%EB%9E%80)<br>
[나무위키 : 인터럽트](https://namu.wiki/w/%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8)<br>
[adam2.log : [OS기초] 인터럽트 제대로 이해하기](https://velog.io/@adam2/%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8)
